<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> iOSè¿è¡Œæ—¶æ›´æ”¹Appè¯­è¨€ Â· 0x5eçš„åšå®¢</title><meta name="description" content="iOSè¿è¡Œæ—¶æ›´æ”¹Appè¯­è¨€ - 0x5e"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://blog.0x5e.cn/atom.xml" title="0x5eçš„åšå®¢"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/imgs/avatar.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/0x5e" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/links/" target="_self" class="nav-list-link">LINK</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">iOSè¿è¡Œæ—¶æ›´æ”¹Appè¯­è¨€</h1><div class="post-info">Jan 22, 2017</div><div class="post-content"><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>ä¸»è¦æ˜¯æ–¹ä¾¿ç ”å‘ä¸æµ‹è¯•åŒå­¦çš„ä½¿ç”¨ï¼Œä¾¿äºéªŒè¯Appåœ¨ä¸åŒè¯­è¨€ä¸‹çš„æ˜¾ç¤ºæ•ˆæœï¼Œå¸Œæœ›èƒ½å¤Ÿåœ¨ç°æœ‰å·¥ç¨‹ä¸æ”¹å˜å¤§é‡ä»£ç çš„æƒ…å†µä¸‹ï¼Œå°½é‡æ»¡è¶³ä¸‹é¢çš„éœ€æ±‚</p>
<ul>
<li>ä¸é‡å¯App</li>
<li>ä¸æ”¹å˜è°ƒç”¨æ–¹å¼ï¼ˆä»ç„¶ç”¨<code>NSLocalizedString</code>ï¼‰</li>
<li>å¯è®¾ç½®é»˜è®¤è¯­è¨€</li>
<li>ç¼ºå¤±è¯­è¨€æé†’/è­¦å‘Š</li>
<li>ä»…åœ¨<code>DEBUG</code>ç¯å¢ƒç”Ÿæ•ˆï¼Œä¸èƒ½å½±å“ç”Ÿäº§ç¯å¢ƒ</li>
<li>å¯¹<code>UIWebView</code>ã€<code>UIBarButtonItem</code>ã€<code>UIPasteboard</code>ç­‰ç³»ç»Ÿç»„ä»¶ä¹Ÿèƒ½å¤Ÿç”Ÿæ•ˆ</li>
</ul>
<a id="more"></a>
<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>å¤šè¯­è¨€æ–‡ä»¶ä¼šè¢«å­˜æ”¾åœ¨<code>&lt;App Bundle Path&gt;/&lt;Language Id&gt;.lproj/</code>ä¸‹ï¼Œå…¶ä¸­<code>*.string</code>åœ¨å·¥ç¨‹ä¸­æ˜¯<code>&quot;key&quot; = &quot;value&quot;;</code>çš„æ–‡æœ¬å½¢å¼ï¼Œç¼–è¯‘åå®é™…ä¸Šæ˜¯äºŒè¿›åˆ¶çš„plistæ–‡ä»¶ï¼Œå¯ä»¥ç”¨<code>plutil -p /path/to/xxx.strings</code>æŸ¥çœ‹ã€‚</p>
<p>å…³äºè¯­è¨€å’Œåœ°åŒºIDï¼š<br><a href="https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPInternational/LanguageandLocaleIDs/LanguageandLocaleIDs.html" target="_blank" rel="noopener">Language and Locale IDs - Apple Developer</a></p>
<p>é¡¹ç›®é‡Œç”¨åˆ°webviewçš„åœ°æ–¹å¾ˆå¤šï¼Œè®¿é—®ä¸åŒçš„é¡µé¢æ—¶ä¹Ÿéœ€è¦æ”¯æŒ<code>Accept-Language</code>çš„åˆ‡æ¢ã€‚</p>
<p>è™½ç„¶æ˜¯ä¸ªè›®å°çš„éœ€æ±‚ï¼Œä½†æ˜¯ç½‘ä¸Šæ‰¾çš„äº›æ–¹æ³•æš‚æ—¶è¿˜æ»¡è¶³ä¸äº†ï¼ˆä¹Ÿæœ‰å¯èƒ½æˆ‘æœç´¢å§¿åŠ¿ä¸å¤ªå¯¹ï¼‰</p>
<h3 id="ç°æœ‰æ–¹æ¡ˆ"><a href="#ç°æœ‰æ–¹æ¡ˆ" class="headerlink" title="ç°æœ‰æ–¹æ¡ˆ"></a>ç°æœ‰æ–¹æ¡ˆ</h3><h4 id="1ã€æ›´æ”¹-NSUserDefaultsä¸­AppleLanguageså­—æ®µçš„å€¼"><a href="#1ã€æ›´æ”¹-NSUserDefaultsä¸­AppleLanguageså­—æ®µçš„å€¼" class="headerlink" title="1ã€æ›´æ”¹ NSUserDefaultsä¸­AppleLanguageså­—æ®µçš„å€¼"></a>1ã€æ›´æ”¹ <code>NSUserDefaults</code>ä¸­<code>AppleLanguages</code>å­—æ®µçš„å€¼</h4><p>è¿™æ˜¯æ¯”è¾ƒè¢«æ¨èçš„åŠæ³•ï¼Œç¼ºç‚¹æ˜¯é‡å¯åº”ç”¨åæ‰ç”Ÿæ•ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[NSUserDefaults standardUserDefaults] setObject:[NSArray arrayWithObjects:@&quot;en&quot;, nil] forKey:@&quot;AppleLanguages&quot;];</span><br><span class="line">[[NSUserDefaults standardUserDefaults] synchronize];</span><br></pre></td></tr></table></figure>
<h4 id="2ã€æ›¿æ¢NSLocalizedStringå®"><a href="#2ã€æ›¿æ¢NSLocalizedStringå®" class="headerlink" title="2ã€æ›¿æ¢NSLocalizedStringå®"></a>2ã€æ›¿æ¢<code>NSLocalizedString</code>å®</h4><p>é¦–å…ˆå®ç°ä¸€ä¸ªè¿è¡Œæ—¶è·å–å¤šè¯­è¨€æ–‡æ¡ˆçš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@implementation NSBundle (RunTimeLanguage)</span><br><span class="line"></span><br><span class="line">+ (NSString *)runTimeLocalizedStringForKey:(NSString *)key &#123;</span><br><span class="line">	// TODO</span><br><span class="line">	NSString *languageId = @&quot;en&quot;;</span><br><span class="line">	</span><br><span class="line">	NSString *path = [[NSBundle mainBundle] pathForResource: languageId ofType:@&quot;lproj&quot;];</span><br><span class="line">    NSBundle *languageBundle = [NSBundle bundleWithPath:path];</span><br><span class="line">    return [languageBundle localizedStringForKey:key value:key table:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨<code>PrefixHeader.pch</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#undef NSLocalizedString</span><br><span class="line">#define NSLocalizedString(key, comment) [NSBundle runTimeLocalizedStringForKey:key]</span><br></pre></td></tr></table></figure>
<p>ç¼ºç‚¹æ˜¯éœ€è¦åœ¨é¢„ç¼–è¯‘å¤´æ–‡ä»¶é‡Œæ·»åŠ å†…å®¹ï¼Œæ„Ÿè§‰ä¸å¤ªä¼˜é›…ã€‚è¿˜æœ‰è¿™æ ·å¯¹webviewä¸ç”Ÿæ•ˆã€‚</p>
<h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><p>æ–¹æ³•ä¸€ä½¿ç”¨çš„æ˜¯ç³»ç»Ÿçš„é€‰å–å¤šè¯­è¨€æ–¹æ³•ï¼Œä¸é‡å¯åº”ç”¨åˆ‡æ¢è¯­è¨€çš„åŠŸèƒ½çœ‹ä¼¼æ— æ³•æ”¯æŒã€‚<br>æ–¹æ³•äºŒçš„å®ç°ä¼šå¯¼è‡´webviewç­‰ç³»ç»Ÿç»„ä»¶ä»ç„¶ä½¿ç”¨äº†ç³»ç»Ÿè¯­è¨€ã€‚</p>
<p>æ„Ÿè§‰ä¸¤ä¸ªæ–¹æ³•æœ‰ç‚¹å†²çª- -ll</p>
<p>äº‰å–åœ¨å‡æœŸé‡Œå®Œæˆè¿™ä¸ªä¸‰æ–¹åº“</p>
<p>ï¼ˆæœ‰äººè¯´todoå°±æ˜¯å†ä¹Ÿä¸doï¼Œå¸Œæœ›ä¸æ˜¯è¿™ä¸ªæ ·å­ğŸ˜Šï¼‰</p>
<p>ä¸ç®¡æ€æ ·ï¼Œå»å¹´çš„æŒ‡æ ‡åœ¨å¹´å‰ç®—æ˜¯è¡¥ä¸Šäº†ï¼šï¼‰@æ¡ƒå°ä¸ƒ</p>
<hr>
<h3 id="Update-2017-1-24"><a href="#Update-2017-1-24" class="headerlink" title="Update 2017/1/24"></a>Update 2017/1/24</h3><p>å°†æ–¹æ¡ˆä¸€å’Œæ–¹æ¡ˆäºŒåšäº†ä¸ªåˆå¹¶ï¼Œä»¿ç…§<code>è®¾ç½® &gt; é€šç”¨ &gt; è¯­è¨€ä¸åœ°åŒº &gt; iPhone è¯­è¨€</code>åšäº†ä¸€ä¸ªé«˜ä»¿çš„<code>GSLanguagePickerController</code>ã€‚</p>
<p><a href="https://github.com/0x5e/GSLanguagePickerController" target="_blank" rel="noopener">0x5e/GSLanguagePickerController</a></p>
<ol>
<li>ä¿®æ”¹è¯­è¨€ï¼Œä¿å­˜è‡³<code>NSUserDefaults</code>ï¼Œé‡å¯åå…¨å±€ç”Ÿæ•ˆ</li>
<li>æ›¿æ¢<code>-[NSBundle localizedStringForKey:value:table:]</code>æ–¹æ³•ï¼Œåœ¨é‡å¯åº”ç”¨å‰å°½å¯èƒ½çš„æ”¯æŒå¤šè¯­è¨€</li>
</ol>
<p>ä¸æ˜¯å¾ˆå®Œç¾ï¼Œç„¶è€Œæœ‰æ€»æ¯”æ²¡æœ‰å¥½ã€‚ã€‚</p>
<p>ç°åœ¨å¯ä»¥è¾¾åˆ°çš„æ•ˆæœæ˜¯ï¼š</p>
<table>
<thead>
<tr>
<th>ä¸€ä¸ªæ™®é€šæ ‡é¢˜</th>
<th style="text-align:center">ç«‹åˆ»ç”Ÿæ•ˆ</th>
<th style="text-align:center">é‡å¯åº”ç”¨åç”Ÿæ•ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>NSLocalizedString</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>UIBarButtonItem</td>
<td style="text-align:center">âˆš(*)</td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>UIWebView</td>
<td style="text-align:center">Ã—</td>
<td style="text-align:center">âˆš</td>
</tr>
</tbody>
</table>
<p>å…¶ä¸­<code>UIBarButtonItem</code>ç­‰ç³»ç»Ÿæ§ä»¶çš„å¤šè¯­è¨€èµ„æºæ˜¯ä»<code>UIKit.frameworks</code>é‡Œè·å–çš„ï¼Œè€Œ<code>UIKit.frameworks/*.lproj</code>å‘½åè§„åˆ™æ¯”è¾ƒæ—§ï¼Œæœ‰å¤šç§æ ¼å¼ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†è¯­è¨€æ— æ³•ç«‹åˆ»ç”Ÿæ•ˆã€‚</p>
<ol>
<li><p><code>[English Name].lproj</code></p>
<p> Examples: <code>English.lproj</code>, <code>French.lproj</code>, <code>German.lproj</code>, <code>Spanish.lproj</code></p>
</li>
<li><p><code>[Language Id]_[Region Id].lproj</code></p>
<p> Examples: <code>zh_CN.lproj</code>, <code>zh_HK.lproj</code>, <code>zh_TW.lproj</code>, <code>en_GB.lproj</code></p>
</li>
<li><p><code>[Language Id]-[Script Id].lproj</code></p>
<p> Examples: <code>zh-Hans.lproj</code>, <code>zh-Hant.lproj</code>, <code>es-ES.lproj</code></p>
</li>
</ol>
<p>å‰ä¸¤ç§æ˜¯å·²è¢«å¼ƒç”¨çš„è§„åˆ™ï¼Œä½†æ˜¯<code>UIKit.frameworks</code>ã€<code>InternationalSettings.bundle</code>ç­‰å¤šå¤„ä»ç„¶å­˜åœ¨ï¼Œç¬¬ä¸‰ç§æ˜¯æ–°è§„åˆ™ï¼Œå¥½åƒæ˜¯iOS 9å¼€å§‹çš„ã€‚</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/03/04/ios-10-jump-to-system-setting/" class="prev">PREV</a><a href="/2017/01/11/nslog-unicode/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = '0x5e';
var disqus_identifier = '2017/01/22/ios-runtime-change-language/';
var disqus_title = 'iOSè¿è¡Œæ—¶æ›´æ”¹Appè¯­è¨€';
var disqus_url = 'https://blog.0x5e.cn/2017/01/22/ios-runtime-change-language/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//0x5e.disqus.com/count.js" async></script><div class="copyright"><p>Â© 2016 - 2019 <a href="https://blog.0x5e.cn">0x5e</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p><p>Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-102733496-1",'auto');ga('send','pageview');</script></body></html>